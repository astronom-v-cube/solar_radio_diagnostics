import numpy as np
import platform

libname = 'gyrosynchrotron/MWTransferArr.so' if platform.system() == 'Linux' else 'gyrosynchrotron/Binaries/MWTransferArr64.dll' # имя исполняемой библиотеки - находится там, где Python сможет ее найти

# список частот, на которых происходит восстановление
# freqs=[5.8e9, 6.2e9, 6.6e9, 7e9, 7.4e9, 7.8e9, 8.2e9, 8.6e9, 9e9, 9.4e9, 9.8e9]
# freqs = np.array([2.8e9, 3e9, 3.2e9, 3.4e9, 3.6e9, 3.8e9, 4e9, 4.2e9, 4.4e9, 4.6e9, 5.2e9, 5.4e9, 5.6e9, 5.8e9, 6.2e9, 6.6e9, 7e9, 7.4e9, 7.8e9, 8.2e9, 8.6e9, 9e9, 9.4e9, 9.8e9, 10.2e9, 10.6e9, 11e9, 11.4e9, 11.8e9])
# freqs = np.array([5.8e9, 6.2e9, 6.6e9, 7e9, 7.4e9, 7.8e9, 8.2e9, 8.6e9, 9e9, 9.4e9, 10.2e9, 10.6e9, 11e9, 11.4e9, 11.8e9]) #


freqs = np.array([3e9, 4e9, 5e9, 6e9, 7e9, 8e9, 9e9, 10e9, 11e9, 12e9, 13e9, 14e9, 15e9, 16e9, 17e9, 18e9, 19e9, 20e9, 21e9, 22e9, 23e9, 24e9][0:7])
############################################################  16.07.23 orig ########################################################
# LLL = [31.21496501, 37.57817085, 44.77493987, 52.81528043, 61.68903641, 71.36393919, 81.7844406 , 92.8714485, 104.5230378, 116.6161538, 154.05870298, 166.37444063, 178.31871827, 189.72118448, 210.26828538, 226.90776355, 238.85343033, 245.7022113 , 247.44062927, 244.40283043, 237.19396425, 226.59594196, 213.47185483, 198.68177437, 183.01776863, 167.1610966, 151.66061244, 136.92884572, 123.2510268] # 1
# RRR = [37.05742648,  43.77823652,  51.16024112,  59.15841689,  67.70620563, 76.7161341, 86.08145014, 95.67872968, 105.37134354, 115.01361538, 142.14464165, 150.11324496, 157.33263036, 163.69981702, 173.56777449, 179.31984509, 180.91418217, 178.62757762, 172.98270359, 164.65759493, 154.39470748, 142.92271047, 130.89857269, 118.87213141, 107.27123955, 96.40316622, 86.46705855, 77.57255579, 69.76059598] # 1

# LLL = [4.23417044, 5.12514972, 6.16378047, 7.36589161, 8.74734408, 10.32369082, 12.10979614, 14.11942164, 16.36478805, 18.85612434, 27.86902017, 31.39133075,  35.16593523,  39.18268603,  47.88039323,  57.31675495,  67.25850608,  77.41692735,  87.46395065,  97.05279581, 105.84105668, 113.51383439, 119.80454283, 124.51136627, 127.50795665, 128.74770711, 128.26170395, 126.15113041, 122.57538952] # 2
# RRR = [4.11548072, 4.95530014, 5.91847366, 7.01329314, 8.24686604, 9.62482232, 11.15104306, 12.82742288, 14.65367776, 16.62720779, 23.36962452, 25.85876894, 28.44724452, 31.11938264, 36.64513755, 42.2884001, 47.89640609, 53.32349821, 58.44207542, 63.15113765, 67.38178887, 71.09956819, 74.30391846, 77.02541689, 79.32155937, 81.27192253, 82.9734573, 84.53653865, 86.08225155] # 2

# LLL = [2.15765142, 2.73232579, 3.42572213, 4.25315546, 5.22974933, 6.36989101, 7.68662445, 9.19100236, 10.89142402, 12.79298965, 19.69418265, 22.36649447, 25.19872564, 28.16767167, 34.3997211, 40.79228183, 47.03144759, 52.79029925, 57.76216931, 61.69139947, 64.39700474, 65.78619892, 65.85673006, 64.68892557, 62.42984843, 59.27278773, 55.43541706, 51.13948381, 46.59406255] 3
# RRR = [1.52118491, 2.01320507, 2.62386105, 3.36905332,  4.26340509,  5.31929898,  6.54589021,  7.94816678,  9.52613191, 11.27418096, 17.39310968, 19.64694673, 21.95678855, 24.2865551, 28.85358979, 33.04732276, 36.60282544, 39.32549931, 41.11067363, 41.94643536, 41.90202899, 41.10682921, 39.72567116, 37.93553854, 35.90694171, 33.79147418, 31.71551925, 29.77912177, 28.05864692] # 3

# LLL = [0.86618888, 1.27694591, 1.83702429, 2.58079956, 3.54327707, 4.7575339, 6.25171381, 8.04583616, 10.14875246, 12.55561507, 21.31875984, 24.5848464, 27.90803877, 31.20770788, 37.41080962, 42.5979835, 46.33973127, 48.44024752, 48.93993701, 48.06627924, 46.15869136, 43.59314385, 40.72400207, 37.85001929, 35.20310659, 32.95421296, 31.2299869 , 30.13556942, 29.78170658] # 1.1
# RRR = [1.10011895, 1.56897899, 2.18383246, 2.96873248, 3.94454781, 5.12651993, 6.52187084, 8.12775698, 9.92985827, 11.90183889, 18.41059028, 20.59595667, 22.6891992, 24.63225442, 27.86871511, 30.00676287, 30.93211285, 30.71051426, 29.54272002, 27.70119974, 25.47007437, 23.10171411, 20.79406411, 18.68592309, 16.86430951, 15.378013, 14.25306807, 13.50802309, 13.16889555] # 1.1 

# LLL = [2.37559319, 3.10550275, 4.00692625, 5.10423735, 6.42112251, 7.97943481, 9.7979425, 11.89103675, 14.26747548, 16.92924641, 26.52727019, 30.18841812, 34.02152106, 37.9798434, 46.05664236, 53.95375336, 61.19350508, 67.34529658, 72.07613279, 75.18339698, 76.60597894, 76.41482766, 74.78781618, 71.97576718, 68.26655453, 63.95284813, 59.30700812, 54.56452182, 49.91566924] # 1.2
# RRR = [2.73947157, 3.49064331, 4.38970898, 5.4499038, 6.68183988, 8.09261134, 9.68496292, 11.45658476, 13.39959228, 15.50024157, 22.52447315, 25.00668418, 27.49947475, 29.96337845, 34.64518597, 38.74918938, 42.02426387, 44.30018467, 45.50184936, 45.64790077, 44.83642562, 43.22248456, 40.99276425, 38.34189513, 35.45349048, 32.48730138, 29.57247347, 26.80594981, 24.25461839] # 1.2

# LLL = [1.97919838, 2.75288695, 3.75450244, 5.02385174, 6.59928829, 8.51507938, 10.7985903, 13.46752041, 16.52745128, 19.96996229, 32.28230423, 36.87252314, 41.58833726, 46.34747492, 55.65630678, 64.15217439, 71.31168107, 76.80789629, 80.53609625, 82.59588164, 83.24399839, 82.8357478, 81.77048889, 80.45127467, 79.26298224, 78.56925539, 78.72691289, 80.11720096, 83.196275] # 1.3
# RRR = [2.37592814, 3.20470044, 4.23941591, 5.50372602, 7.01629004, 8.78872666, 10.82380172, 13.11405179, 15.64101412, 18.37518071, 27.38050373, 30.46775354, 33.497846, 36.41149639, 41.67622875, 45.91262169, 48.92282947, 50.6720923, 51.26794444, 50.91957516, 49.89160073, 48.46362617, 46.90208792, 45.44627067, 44.30738615, 43.67851011, 43.75375288, 44.75696325, 46.98353881] # 1.3 

# LLL = [1.84003942, 2.49610478, 3.32714917, 4.35993426, 5.61966272, 7.12832732, 8.90300306, 10.95421725, 13.28454084, 15.88753611, 25.12463178, 28.56493556, 32.10951594, 35.70472295, 42.82342647, 49.48754943, 55.33051752, 60.1012114, 63.68642778, 66.10756868, 67.49810373, 68.0712165, 68.0867282, 67.82407711, 67.56522939, 67.58899889, 68.17695943, 69.63114882, 72.30515649] # 1.4
# RRR = [1.70726457, 2.29831004, 3.03625267, 3.93865393, 5.01992764, 6.28993153, 7.75268806, 9.40536684, 11.23764505, 13.23153191, 19.89835237, 22.22715998, 24.54039824, 26.79594729, 30.97777256, 34.50643017, 37.21272657, 39.03888518, 40.03046356, 40.31289332, 40.06178521, 39.47502803, 38.75192288, 38.08163354, 37.64109295, 37.60157751, 38.14344646, 39.47995634, 41.8937372] # 1.4

# LLL = [2.51505793, 3.34855318, 4.38539822, 5.65237215, 7.17380535, 8.97000753, 11.0557359, 13.43882764, 16.11911679, 19.0877387, 29.50305503, 33.36462574, 37.34867159, 41.40577766, 49.53728188, 57.37437192, 64.6005572, 71.00764944, 76.51429243, 81.16458238, 85.11284682, 88.60255514, 91.94708206, 95.51866339, 99.7505058, 105.15660722, 112.37523639, 122.24617221, 135.94039363] # 2.1
# RRR = [2.40361818, 3.19048182, 4.15781233, 5.32316956, 6.69964081, 8.29444887, 10.10781626, 12.13221017, 14.35206152, 16.74400784, 24.6212083, 27.34812175, 30.05462982, 32.69941561, 37.65714319, 41.98378483, 45.54855374, 48.33462235, 50.42718771, 51.99071565, 53.24433629, 54.44268839, 55.8671063, 57.83026851, 60.69719263, 64.9274448, 71.14858668, 80.28130975, 93.7572313] # 2.1

# LLL = [2.42377074, 3.06212474, 3.82651429, 4.73099166, 5.78880167, 7.01184109, 8.41010907, 9.99117626, 11.75970171, 13.71702545, 20.67984128, 23.33131801, 26.12231175, 29.03243537, 35.11581957, 41.37627513, 47.59740861, 53.57382524, 59.13076935, 64.13868065, 68.52140019, 72.25805123, 75.3796582, 77.96219917, 80.11799855, 81.98724428, 83.7310947, 85.52747012, 87.5703235] # 2.2
# RRR = [2.09458219, 2.63511872, 3.27511076, 4.02278919, 4.88490905, 5.8663243, 6.96961007, 8.19475873, 9.53897237, 10.99656862, 15.9510604, 17.75130871, 19.59853574, 21.47443544, 25.23727507, 28.89429474, 32.31843118, 35.41413036, 38.12506866, 40.43635802, 42.37213829, 43.99013369, 45.37496878, 46.63190492, 47.88233691, 49.26205069, 50.92302643, 53.03958297, 55.81999242] # 2.2

# LLL = [1.53340416, 1.88352398, 2.29207414, 2.76404309, 3.30396361, 3.91575627, 4.60258328, 5.36671976, 6.20944943, 7.13099019, 10.35409219, 11.5711251, 12.8519785, 14.19093092, 17.01746151, 19.99643133, 23.07327688, 26.19934032, 29.33735568, 32.4658174, 35.58211158, 38.70457715, 41.87389944, 45.15441161, 48.63600636, 52.43747819, 56.71227831, 61.65794304, 67.53094773] # 2.3
# RRR = [0.82902546, 1.0493141, 1.3120257, 1.62122781, 1.98050662, 2.39279109, 2.86019193, 3.38386603, 3.96391574, 4.59933048, 6.81107589, 7.63622149, 8.496277, 9.38494727, 11.22173446, 13.09448455, 14.95693251, 16.77443132, 18.52804772, 20.21685222, 21.85872729, 23.49032928, 25.16701296, 26.96360861, 28.97700982, 31.3316864, 34.18960333, 37.76677309, 42.3600691] # 2.3

# LLL = [1.23281513, 1.52654455, 1.86330915, 2.24393045, 2.66842611, 3.13604069, 3.64531825, 4.19420961, 4.78020514, 5.40048286, 7.43729485, 8.1654786, 8.91424555, 9.68176573, 11.26819037, 12.92019065, 14.64135885, 16.44251542, 18.34004302, 20.35366347, 22.50370473, 24.80777451, 27.27666206, 29.90926005, 32.68636728, 35.56344432, 38.46279984, 41.26632157, 43.81071968] # 2.4
# RRR = [0.63179544, 0.83568434, 1.07863739, 1.36090948, 1.68123987, 2.03692905, 2.42404116, 2.83770351, 3.27246526, 3.72267494, 5.11367153, 5.57662241, 6.0343668, 6.48549585, 7.36715746, 8.22873219, 9.08868962, 9.97314002, 10.91238205, 11.93786556, 13.07927062, 14.36111319, 15.79814914, 17.38887149, 19.10666995, 20.88892653, 22.62567965, 24.1516152, 25.24772082] # 2.4

# LLL = [1.16666301, 1.62016158, 2.19814911, 2.91739797, 3.79235841, 4.83409729, 6.04940314, 7.44014315, 9.00292948, 10.72911855, 16.73146882, 18.93637325, 21.20223069, 23.50294169, 28.10705263, 32.55973144, 36.70543056, 40.42799769, 43.64774009, 46.31279108, 48.38811138, 49.84488472, 50.65230717, 50.77312623, 50.16383851, 48.78010914, 46.58753294, 43.57708805, 39.78337992] # 3.1
# RRR = [0.85420938, 1.24821049, 1.76591235, 2.42377393, 3.23377191, 4.20186843, 5.32698678, 6.60063972, 8.00725469, 9.52513747, 14.47019446, 16.14977242, 17.79773757, 19.39006639, 22.33262368, 24.8715192, 26.96638774, 28.6258335, 29.88592149, 30.7898642, 31.37199988, 31.64695073, 31.6038453, 31.20547214, 30.39274846, 29.09540608, 27.24972793, 24.82290007, 21.84067202] # 3.1 

# LLL = [0.9798001, 1.26915954, 1.61742552, 2.02962552, 2.50976918, 3.06061745, 3.68350575, 4.37823216, 5.14301661, 5.97453091, 8.81534716, 9.85398996, 10.92455666, 12.01795026, 14.23619722, 16.43611675, 18.55059804, 20.52095002, 22.29773557, 23.83999926, 25.11353488, 26.08885797, 26.73947713, 27.04094763, 26.97106639, 26.51142859, 25.65039507, 24.38728997, 22.73734482] # 3.2
# RRR = [0.64015296, 0.87832012, 1.17063722, 1.51880839, 1.92207292, 2.37718116, 2.87861697, 3.41902751, 3.98979556, 4.58167779, 6.39485917, 6.98649562, 7.56241788, 8.11927248, 9.16951005, 10.13656132, 11.03376217, 11.88082755, 12.69668234, 13.49315186, 14.26934308, 15.00646901, 15.66326459, 16.17295116, 16.4438005, 16.3663747, 15.83070664, 14.75484015, 13.12117448] # 3.2


############################################################  20.01.22 orig ########################################################
# LLL = [1.0958675536105382, 1.2237082485236424, 1.349040333458388, 1.4682472945404068, 1.5776138567632905, 1.6735143593307928, 1.7526104708901693, 1.8120433740590038, 1.8496050560375068, 1.8638744148418018, 1.8212669925427074, 1.7660091270760911, 1.690594682915495, 1.5977663916990343, 1.4907825230179232] # 1.1 peak
# RRR = [1.092141190188407, 1.1856275844488393, 1.2757152920145824, 1.3604894753927592, 1.4380453098048092, 1.5065581942939965, 1.5643546319519608, 1.6099799642343697, 1.642259144584725, 1.6603470112862913, 1.652422470266025, 1.6266201332729726, 1.5870373702225367, 1.534702220983287, 1.4709470798972486] # 1.1 peak

# LLL = [1.9906678908893212, 2.2744994574450095, 2.576790509397226, 2.8945338681021893, 3.2239211193482977, 3.560380612988079, 3.8986540224557538, 4.232911745974073, 4.556905051722593, 4.864150391070209, 5.402562112372518, 5.621542891961966, 5.799860357493422, 5.933156368876262, 6.018112472630124] # 1.2 peak
# RRR = [2.104980090798897, 2.387284564147174, 2.690169455630095, 3.0121343225169883, 3.3511069018497897, 3.704430742745604, 4.068871056753565, 4.4406405940387135, 4.815446611477359, 5.188559122300668, 5.9091486462567975, 6.245868875690553, 6.559640825339857, 6.845205770193213, 7.097611199603058] # 1.2 peak

# LLL = [3.8119756390868975, 4.482344108531767, 5.222298687018844, 6.028644243866652, 6.895710830515793, 7.8151957713645235, 8.776111205653313, 9.764855242388247, 10.765418985839172, 11.759734053513649, 13.65007173814981, 14.504601589198375, 15.271373891257166, 15.931323333015388, 16.46747562735365] # 1.2.2 peak
# RRR = [3.873552017955156, 4.5741178915792595, 5.357031770503569, 6.222429679096799, 7.168275354404841, 8.190082353216509, 9.28070065518896, 10.430188759860892, 11.625790117833109, 12.852028959540485, 15.322401944994832, 16.524669756427432, 17.674927214453703, 18.75000492564728, 19.727136300360556] # 1.2.2 peak

# LLL = [5.0076249686659615, 5.633235212649595, 6.326236958168123, 7.092420969708702, 7.937889260863017, 8.869048853678068, 9.892602046882253, 11.015532882095489, 12.245089508184964, 13.588762160579423, 16.649462043884625, 18.382415599642673, 20.261259370263485, 22.294193802680155, 24.48942502409576] # 1.3 peak
# RRR = [5.0594853741661465, 5.734793545711346, 6.4863996138986275, 7.320893430567436, 8.245157178488087, 9.266340689989953, 10.391830598899892, 11.629212965982452, 12.986229076184907, 14.47072417672715, 17.85369407969924, 19.767816737353094, 21.840561214774123, 24.079271959064116, 26.490940684080677] # 1.3 peak

# LLL = [4.756284088437122, 5.467157601394054, 6.254552749429029, 7.121505027238985, 8.070271959629347, 9.102179896488028, 10.217473467071912, 11.415172585057284, 12.692942267463287, 14.046980738895583, 16.96082330024464, 18.50504690153321, 20.094366085796977, 21.71697290497806, 23.35958528917831] # 1.4 peak
# RRR = [4.842498093696696, 5.606752084200421, 6.460530881788307, 7.408666052208676, 8.45525657165493, 9.603477448671267, 10.855384478475987, 12.211720565373767, 13.67172974376014, 15.232985567733207, 18.640306054554937, 20.471962677630287, 22.37591905846466, 24.33981329295744, 26.349268410973657] # 1.4 peak

# LLL = [4.982911581292407, 5.741620449761444, 6.589650542726093, 7.532981362371324, 8.577248778289087, 9.727600478679138, 10.98854140714974, 12.363771712093037, 13.856020300097098, 15.466877620855897, 19.044112598876524, 21.006548136706908, 23.079439184172177, 25.25645625026888, 27.529364247536055] # 2.2 peak
# RRR = [5.131705925942371, 5.941342133457325, 6.850444957316232, 7.866189750962324, 8.99542058433663, 10.244480667869256, 11.619029084701209, 13.12384669407451, 14.762634804017585, 16.53781092258729, 20.499372564069322, 22.682398118871635, 24.9947494257759, 27.429634698453512, 29.978001601058104] # 2.2 peak
# без 9800

# LLL = [5.286208064658368, 5.965260851340236, 6.714698518545992, 7.53937749964753, 8.444158029442951, 9.433853068156484, 10.513171657094516, 11.686656937744143, 12.958619192272337, 14.33306439675686, 17.403451114939408, 19.10519078087527, 20.920847426286937, 22.851728618535137, 24.898359638511334] # 2.3 peak
# RRR = [5.520622560574012, 6.243222620126256, 7.041139224132048, 7.919365499353411, 8.882826671693016, 9.936314603647956, 11.084416204087704, 12.331436205871189, 13.68131497991566, 15.13754223251334, 18.38020942621164, 20.170562841249307, 22.07490908262625, 24.093127298874116, 26.224110854905145] # 2.3 peak
# без 9800

# LLL = [4.972886676816091, 5.580216694365495, 6.247278538697738, 6.977952027020576, 7.776109959774491, 8.645579548659704, 9.590099942522787, 10.613276025144597, 11.718528742037124, 12.909042300703094, 15.557069967657583, 17.019259163594526, 18.57594011886338, 20.228247432870152, 21.97672715160794] # 2.4 peak
# RRR = [5.192156754632796, 5.831200071260472, 6.533693136061791, 7.303821791869617, 8.145771941750565, 9.063688464410745, 10.061629848087255, 11.14351871667474, 12.313088511971491, 13.573826691043898, 16.3811666558026, 17.932963272144953, 19.586188653561884, 21.342163935590555, 23.20158282447414] # 2.4 peak

# LLL = [4.667654217703558, 5.197425749453596, 5.773164579319911, 6.396989087187296, 7.0708774142404796, 7.796631946354614, 8.575842272572691, 9.409847029369228, 10.299695104067112, 11.246106730151624, 13.309628861081748, 15.598175303996646, 16.824096972920447, 18.101966451198503] # 2.5 peak
# RRR = [4.907359302843312, 5.464509986606096, 6.072685969874892, 6.734985352100517, 7.454503448695528, 8.234306282987983, 9.077401528951048, 9.986707001018742, 10.965016833715515, 12.014965542684426, 14.33929108283855, 16.976093635828434, 18.415442179933795, 19.936677014177132] # 2.5 peak

LLL = [3.775945330587186, 4.913003757202509, 6.430090152331687, 8.474615790881288, 11.266597384155105, 15.095527815086314, 19.844799595720193, 24.024412206770087, 25.63637462788862, 24.191843835599446, 20.709215127936247, 16.499661389114618, 12.465754068790224, 9.037699541537169, 6.332149956060029, 4.304759143801421, 2.846285816430415, 1.8333814241503186, 1.1523177378145064, 0.7082144106212358, 0.426953797963327, 0.25361346887132064][0:7]

RRR = [3.056931495231541, 4.055646908638111, 5.380688249110566, 7.16074367466725, 9.573894674832504, 12.861305992129832, 17.34165840531344, 23.46856801291561, 31.77272385506728, 40.72186400912395, 44.91304252864726, 41.71918757681618, 33.90319499328829, 25.149882072593662, 17.537502672077963, 11.696434775773643, 7.532583478471152, 4.708805891245011, 2.8663040821066272, 1.7032099145806159, 0.9907810679161762, 0.5663862585547056][0:7]


reference = []
for i in range(len(LLL)):
    reference.append(LLL[i])
    reference.append(RRR[i])
reference = np.array(reference)

Nf=len(freqs)       # number of frequencies
NSteps=10  # number of nodes along the line-of-sight
space_freqs = np.logspace(np.log10(freqs[0]), np.log10(freqs[-1]), Nf)
space_freqs = freqs

Lparms=np.zeros(11, dtype='int32') # массив измерений и т.д.
Lparms[0]=NSteps
Lparms[1]=Nf
 
Rparms=np.zeros(5, dtype='double') # массив глобальных параметров с плавающей запятой
Rparms[0]=(1.75 * 1e8 * 1.75 * 1e8) * 9  # площадь, см^2
Rparms[1]=freqs[0]
Rparms[2]=(np.log10(freqs[-1])-np.log10(freqs[0]))/(Nf-1)
# Rparms[3]=12   #f^C
# Rparms[4]=12   #f^WH
 
L=3e8 # общая глубина источника, см
# индексы восстанавливаемых параметров
recoverable_params_indexes = [1, 2, 3, 4, 7, 11, 12, 13] 
# recoverable_params = np.array([1.9e6, 1.2e+11, 131, 122, 4.5e+10, 6.44], dtype='double')
recoverable_params = np.array([1e7, 1e10, 225, 80, 3e6, 0.3, 3, 8], dtype='double')
recoverable_params_analise = np.array([8.56e+07, 1.01e+08, 3.0334e+02, 1.75e+02, 2.612e+08, 9.11e-02, 7.62e-01, 4.2e+01], dtype='double')
recoverable_params_analise = np.array([1e7, 1e10, 225, 80, 3e6, 0.3, 3, 8], dtype='double')


ParmLocal=np.zeros(24, dtype='double') # массив параметров вокселя - для одного вокселя
ParmLocal[0]=L/NSteps  # глубина вокселя, см
#ParmLocal[1]=d[0]  # T_0, K
#ParmLocal[2]=d[1]   # n_0 - тепловая электронная плотность, см^{-3}
#ParmLocal[3]=d[2]  # B - магнитное поле, G
#ParmLocal[4]=d[3]    #угол между В и лучом зрения
ParmLocal[6]=4     # распределение по энергии (выбирается ЗАКОН LAW)
#ParmLocal[7]=d[4]  # n_b - нетепловая электронная плотность, см^{-3}
ParmLocal[9]=0.03   # E_min, MeV
ParmLocal[10]=10 # E_max, MeV
# ParmLocal[11]=0.3 # E_break, MeV
#ParmLocal[12]=d[5]  # \delta_1
#ParmLocal[13]=d[5]  # \delta_2
ParmLocal[14]=0    # распределение по питч-углу (выбирается GLC), 0 - изотропное
ParmLocal[15]=10   # граница конуса потерь, градусы
ParmLocal[16]=0.2  # \Delta\mu

limits_of_gen_ParmLocal = np.zeros(24, dtype=[('min', float), ('max', float), ('axes_scale', 'U10')])
limits_of_gen_ParmLocal[1]=(1e6, 1e8, 'log')   # T_0, K
limits_of_gen_ParmLocal[2]=(1e8, 1e11, 'log')  # n_0 - тепловая электронная плотность, см^{-3}
limits_of_gen_ParmLocal[3]=(20, 1000, 'linear')   # B - магнитное поле, G
limits_of_gen_ParmLocal[4]=(0, 360, 'linear')   #угол между В и лучом зрения
# limits_of_gen_ParmLocal[5]= 0 + 4
# limits_of_gen_ParmLocal[6]=3     # распределение по энергии (выбирается ЗАКОН LAW)
limits_of_gen_ParmLocal[7]=(1e3, 1e10, 'log')   # n_b - нетепловая электронная плотность, см^{-3}
# limits_of_gen_ParmLocal[9]=0.03   # E_min, MeV
# limits_of_gen_ParmLocal[10]=10.0 # E_max, MeV
limits_of_gen_ParmLocal[12]=(2.0, 7.0, 'linear')  # \delta_1
# limits_of_gen_ParmLocal[14]=3    # # распределение по питч-углу (выбирается GLC)
limits_of_gen_ParmLocal[15]=(0, 360, 'linear')   # граница конуса потерь, градусы
# limits_of_gen_ParmLocal[16]=1  # \Delta\mu
# limits_of_gen_ParmLocal[22]=-1  # \Delta\mu

names_of_ParmLocal = [''] * 24
names_of_ParmLocal[1]=r'$T_0, K$'
names_of_ParmLocal[2]=r'$n_0, sm^{-3}$'
names_of_ParmLocal[3]=r'$B, G$'
names_of_ParmLocal[4]=r'$\theta, grad$'
names_of_ParmLocal[7]=r'$n_b, sm^{-3}$'
names_of_ParmLocal[9]=r'$E_{min}, MeV$'
names_of_ParmLocal[10]=r'$E_{max}, MeV$'
names_of_ParmLocal[11]=r'$E_{break}, MeV$'
names_of_ParmLocal[12]=r'$\delta_1$'
names_of_ParmLocal[13]=r'$\delta_2$'
names_of_ParmLocal[15]=r'$theta_2$'   # граница конуса потерь, градусы
# names_of_ParmLocal[16]=1  # \Delta\mu
# names_of_ParmLocal[22]=-1  # \Delta\mu